!(function ($, window) {
    var factsheetPrimaryInputs = $(".factsheet-primary-inputs");
    var deadlineTemplate = $("#factsheet-deadline-template").html();
    var deadlineTemplateProg = $("#factsheet-deadlines_prog-template").html();
    var requirementTemplate = $("#factsheet-requirement-template").html();
    var requirementTemplateGre = $("#factsheet-requirement-gre-template").html();
    var deadlineFormCount = $("#factsheet_deadline_form_count").val();
    var deadlineProgFormCount = $("#factsheet_deadlines_prog_form_count").val();
    var requirementFormCount = $("#factsheet_requirement_form_count").val();
    var requirementFormCountGre = $("#factsheet_requirement_form_gre_count").val();
    var contactsCount = $("#factsheet_gscontacts_count").val();
    var contactTemplate = $("#factsheet-gscontacts-template").html();
  
    factsheetPrimaryInputs.on("click", ".add-factsheet-deadlines-field", function (event) {
      var target = $(event.target);
      var compiledTemplate = _.template(deadlineTemplate);
      target.before(compiledTemplate({ form_count: deadlineFormCount }));
      deadlineFormCount++;
    });
  
    factsheetPrimaryInputs.on("click", ".remove-factsheet-deadlines-field", function (event) {
      $(event.target).parent(".factsheet-deadlines-field").remove();
    });

    factsheetPrimaryInputs.on("click", ".add-factsheet-deadlines_prog-field", function (event) {
      var target = $(event.target);
      var compiledTemplate = _.template(deadlineTemplateProg);
      target.before(compiledTemplate({ form_count: deadlineProgFormCount }));
      deadlineProgFormCount++;
    });
  
    factsheetPrimaryInputs.on("click", ".remove-factsheet-deadlines_prog-field", function (event) {
      $(event.target).parent(".factsheet-deadlines_prog-field").remove();
    });
  
    factsheetPrimaryInputs.on("click", ".add-factsheet-requirements-field", function (event) {
      var target = $(event.target);
      var compiledTemplate = _.template(requirementTemplate);
      target.before(compiledTemplate({ form_count: requirementFormCount }));
      requirementFormCount++;
    });

    factsheetPrimaryInputs.on("click", ".add-factsheet-gscontacts-field", function (event) {
      var target = $(event.target);
      var compiledTemplate = _.template(contactTemplate);
      target.before(compiledTemplate({ form_count: contactsCount }));
      contactsCount++;
    });

    factsheetPrimaryInputs.on("click", ".remove-factsheet-gscontacts-field", function (event) {
      $(event.target).parent(".factsheet-gscontacts-field").remove();
    });


    factsheetPrimaryInputs.on("click", ".add-factsheet-requirements-gre-field", function (event) {
        var target = $(event.target);
        var compiledTemplate = _.template(requirementTemplateGre);
        target.before(compiledTemplate({ form_count: requirementFormCountGre }));
        requirementFormCountGre++;
      });
  
    factsheetPrimaryInputs.on("click", ".remove-factsheet-requirements-gre-field", function (event) {
        $(event.target).parent(".factsheet-requirements-gre-field").remove();
      });
    
      factsheetPrimaryInputs.on("click", ".remove-factsheet-requirements-field", function (event) {
      $(event.target).parent(".factsheet-requirements-field").remove();
    });
  
  })(jQuery, window);